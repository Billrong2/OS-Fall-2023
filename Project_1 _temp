#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/*
 * This program counts the number of sentences in a given string and
 * the number of tokens each in sentence.
 * Terminates when user enters BYE
 */

int main(int argc, char *argv[])
{
    // define the required variables
    const char sentencebreaker[] = ".";
    const char wordbreaker[] = " ";
    char *input = NULL;
    char *sentence = NULL;
    char *words = NULL;
    size_t length = 0;
    size_t read = 0;
    while (1)
    {
     	printf("xxr_dash$: ");
        read = getline(&input, &length, stdin);
        if (read == -1)
        {
            printf("Error reading input.\n");
            return 1;
        }
        int i = 0;
        char *sentence_token = strtok_r(input, sentencebreaker,&sentence);
        while (sentence_token != NULL) {
            i++;
            char* inner_token = strtok_r(sentence_token, wordbreaker, &words);
            if (inner_token != NULL && i==1 && (strcmp(inner_token, "BYE") ==0 || strcmp(inner_token, "BYE\n") == 0)) {
                printf("Goodbye, exiting shell ... \n");
                return 0;
            }
            while(inner_token!= NULL){
                inner_token = strtok_r(NULL, wordbreaker,&words);
        }
	sentence_token = strtok_r(NULL, sentencebreaker,
                         &sentence);
        }
    }
    exit(EXIT_SUCCESS);
}
